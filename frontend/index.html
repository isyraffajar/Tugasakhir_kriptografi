<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Crypto-Vault - Penyimpanan Data Terenkripsi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="d-flex">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="brand-logo">
                    <i class="bi bi-shield-lock"></i>
                </div>
                <h5 class="brand-name">Crypto-Vault</h5>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active" data-section="dashboard">
                        <i class="bi bi-speedometer2"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#mynotes" class="nav-link" data-section="mynotes">
                        <i class="bi bi-file-text"></i>
                        <span>MyNotes</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#myfiles" class="nav-link" data-section="myfiles">
                        <i class="bi bi-folder"></i>
                        <span>MyFile</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#mystegano" class="nav-link" data-section="mystegano">
                        <i class="bi bi-image"></i>
                        <span>MyStegano</span>
                    </a>
                </li>
            </ul>

            <div class="sidebar-footer">
                <a href="#" class="profile-link">
                    <img src="{{ url_for('static', filename='img/default-profile.png') }}" alt="Profile"
                        class="profile-img">
                    <span class="profile-name">{{ username }}</span>
                </a>
                <a href="{{ url_for('logout') }}" class="logout-btn" onclick="return confirmLogout()">
                    <i class="bi bi-box-arrow-right"></i>
                </a>
                <!-- Event handler untuk logout -->
                <script>
                    function confirmLogout() {
                        return confirm("Apakah Anda yakin ingin logout?");
                    }
                </script>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <button class="btn-toggle-sidebar" id="toggleSidebar">
                        <i class="bi bi-list"></i>
                    </button>
                    <h1 class="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <i class="bi bi-search"></i>
                        <input type="text" placeholder="Cari file atau catatan...">
                    </div>
                    <button class="btn-notification">
                        <i class="bi bi-bell"></i>
                        <span class="notification-badge">3</span>
                    </button>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="content-wrapper">
                <!-- Dashboard Section -->
                <section id="dashboard-section" class="section active">
                    <div class="container-fluid">
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="stats-card">
                                    <div class="stats-icon notes-icon">
                                        <i class="bi bi-file-text"></i>
                                    </div>
                                    <div class="stats-content">
                                        <h6 class="stats-label">Total Catatan</h6>
                                        <h3 class="stats-value">{{ total_notes }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-card">
                                    <div class="stats-icon files-icon">
                                        <i class="bi bi-folder"></i>
                                    </div>
                                    <div class="stats-content">
                                        <h6 class="stats-label">Total File</h6>
                                        <h3 class="stats-value">{{ total_files }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-card">
                                    <div class="stats-icon pictures-icon">
                                        <i class="bi bi-image"></i>
                                    </div>
                                    <div class="stats-content">
                                        <h6 class="stats-label">Total Gambar</h6>
                                        <h3 class="stats-value">45</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stats-card">
                                    <div class="stats-icon storage-icon">
                                        <i class="bi bi-hdd"></i>
                                    </div>
                                    <div class="stats-content">
                                        <h6 class="stats-label">Penyimpanan</h6>
                                        <h3 class="stats-value">2.5 GB</h3>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card content-card">
                                    <div class="card-header">
                                        <h5 class="card-title mb-0">File Terbaru</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="file-list">
                                            <div class="file-item">
                                                <div class="file-icon">
                                                    <i class="bi bi-file-pdf"></i>
                                                </div>
                                                <div class="file-info">
                                                    <h6 class="file-name">Document.pdf</h6>
                                                    <small class="file-date">2024-11-05 | 2.5 MB</small>
                                                </div>
                                                <div class="file-actions">
                                                    <button class="btn-icon" title="Download">
                                                        <i class="bi bi-download"></i>
                                                    </button>
                                                    <button class="btn-icon" title="Delete">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="file-item">
                                                <div class="file-icon">
                                                    <i class="bi bi-file-word"></i>
                                                </div>
                                                <div class="file-info">
                                                    <h6 class="file-name">Notes.docx</h6>
                                                    <small class="file-date">2024-11-04 | 1.2 MB</small>
                                                </div>
                                                <div class="file-actions">
                                                    <button class="btn-icon" title="Download">
                                                        <i class="bi bi-download"></i>
                                                    </button>
                                                    <button class="btn-icon" title="Delete">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="file-item">
                                                <div class="file-icon">
                                                    <i class="bi bi-file-excel"></i>
                                                </div>
                                                <div class="file-info">
                                                    <h6 class="file-name">Data.xlsx</h6>
                                                    <small class="file-date">2024-11-03 | 890 KB</small>
                                                </div>
                                                <div class="file-actions">
                                                    <button class="btn-icon" title="Download">
                                                        <i class="bi bi-download"></i>
                                                    </button>
                                                    <button class="btn-icon" title="Delete">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- MyNotes Section -->
                <section id="mynotes-section" class="section">
                    <div class="container-fluid">
                        <div class="section-header">
                            <h2 class="section-title">Catatan Pribadi</h2>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newNoteModal">
                                <i class="bi bi-plus-lg"></i> Catatan Baru
                            </button>

                            <!-- Modal Catatan Baru -->
                            <div class="modal fade" id="newNoteModal" tabindex="-1" aria-labelledby="newNoteModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <form id="newNoteForm" method="POST" action="{{ url_for('add_note_route') }}">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="newNoteModalLabel">Catatan Baru</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="mb-3">
                                                    <label for="noteTitle" class="form-label">Judul Catatan</label>
                                                    <input type="text" class="form-control" id="noteTitle" name="title"
                                                        required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="noteContent" class="form-label">Isi Catatan</label>
                                                    <textarea class="form-control" id="noteContent" name="note"
                                                        rows="5"></textarea>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Batal</button>
                                                <button type="submit" class="btn btn-primary">Simpan Catatan</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <!-- End of Modal Catatan baru -->

                            <!-- Modal Detail Note -->
                            <div class="modal fade" id="noteModal" tabindex="-1" aria-labelledby="noteModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <form id="noteForm" method="POST" action="{{ url_for('update_note_route') }}">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="noteModalLabel">Detail Catatan</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <input type="hidden" name="note_id" id="modalNoteId">
                                                <div class="mb-3">
                                                    <label for="modalNoteTitle" class="form-label">Judul</label>
                                                    <input type="text" class="form-control" id="modalNoteTitle"
                                                        name="title" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="modalNoteContent" class="form-label">Catatan</label>
                                                    <textarea class="form-control" id="modalNoteContent" name="note"
                                                        rows="8" required></textarea>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Tutup</button>
                                                <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <!-- End of Modal Detail Note -->

                            <!-- Modal Konfirmasi Hapus -->
                            <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog modal-sm">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="deleteModalLabel">Konfirmasi Hapus</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            Apakah Anda yakin ingin menghapus catatan ini?
                                        </div>
                                        <div class="modal-footer">
                                            <form id="deleteForm" method="POST"
                                                action="{{ url_for('delete_note_route') }}">
                                                <input type="hidden" name="note_id" id="deleteNoteId">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Batal</button>
                                                <button type="submit" class="btn btn-danger">Hapus</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            {% for note in notes %}
                            <div class="col-md-6 col-lg-4 mb-4">
                                <div class="note-card" data-note-id="{{ note.note_id }}" data-title="{{ note.title }}"
                                    data-note="{{ note.note }}">
                                    <div class="note-header">
                                        <h5 class="note-title">{{ note.title }}</h5>
                                        <button class="btn-icon text-danger" data-note-id="{{ note.note_id }}">
                                            <i class="bi bi-trash-fill"></i>
                                        </button>
                                    </div>
                                    <div class="note-content">
                                        <p>{{ note.note }}</p>
                                    </div>
                                    <div class="note-footer">
                                        <small>Created at {{ note.created_at }}</small>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% if not notes %}
                            <table class="table table-hover">
                                <td colspan="5" class="text-center">Belum ada catatan yang di-upload.</td>
                            </table>
                            {% endif %}
                        </div>
                    </div>
                </section>
                <!-- End of MyNotes Section -->

                <!-- MyFile Section -->
                <section id="myfiles-section" class="section">
                    <div class="container-fluid">
                        <div class="section-header">
                            <h2 class="section-title">File Pribadi</h2>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newFileModal">
                                <i class="bi bi-upload"></i> Upload File
                            </button>
                            <!-- Modal Files Baru -->
                            <div class="modal fade" id="newFileModal" tabindex="-1" aria-labelledby="newFileModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <form id="newFileForm" method="POST" action="{{ url_for('upload_file_route') }}"
                                            enctype="multipart/form-data">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="newFileModalLabel">Upload File Baru</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="mb-3">
                                                    <label for="fileUpload" class="form-label">Pilih File</label>
                                                    <input type="file" class="form-control" id="fileUpload" name="file"
                                                        required>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Batal</button>
                                                <button type="submit" class="btn btn-primary">Upload File</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <!-- End of Modal File baru -->
                        </div>
                        <div class="files-grid">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Nama File</th>
                                        <th>Tipe</th>
                                        <th>Ukuran</th>
                                        <th>Tanggal</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for file in files %}
                                    <tr>
                                        <td>
                                            <i class="bi bi-file-earmark"></i> {{ file.filename }}
                                        </td>
                                        <td>File</td>
                                        <td>-</td>
                                        <td>{{ file.uploaded_at.strftime('%Y-%m-%d') }}</td>
                                        <td>
                                            <a href="{{ url_for('download_file_route', file_id=file.file_id) }}"
                                                class="btn btn-sm btn-outline-primary" title="Download">
                                                <i class="bi bi-download"></i>
                                            </a>

                                            <form action="{{ url_for('delete_file_route', file_id=file.file_id) }}"
                                                method="POST" style="display: inline-block;">
                                                <button type"submit" class="btn btn-sm btn-outline-danger" title="Hapus"
                                                    onclick="return confirm('Apakah Anda yakin ingin menghapus file \'{{ file.filename }}\' secara permanen?')">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </form>
                                        </td>
                                    </tr>
                                    {% endfor %}

                                    {% if not files %}
                                    <tr>
                                        <td colspan="5" class="text-center">Belum ada file yang di-upload.</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                <!-- End of MyFile Section -->

                <!-- MyStegano Section -->
                <section id="mystegano-section" class="section">
                    <div class="container-fluid">
                        <div class="section-header">
                            <h2 class="section-title">Steganografi - Sembunyikan Pesan dalam Gambar</h2>
                        </div>

                        <!-- Tabs untuk dua fitur -->
                        <ul class="nav nav-tabs mb-4" id="steganoTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="hide-tab" data-bs-toggle="tab"
                                    data-bs-target="#hide-panel" type="button" role="tab">
                                    <i class="bi bi-eye-slash"></i> Sembunyikan Pesan
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="reveal-tab" data-bs-toggle="tab"
                                    data-bs-target="#reveal-panel" type="button" role="tab">
                                    <i class="bi bi-eye"></i> Tampilkan Pesan
                                </button>
                            </li>
                        </ul>


                        <!-- Tab Content -->
                        <div class="tab-content" id="steganoTabContent">
                            <!-- Hide Message Tab -->
                            <div class="tab-pane fade show active" id="hide-panel" role="tabpanel">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <div class="card content-card">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">Sembunyikan Pesan dalam Gambar</h5>
                                            </div>
                                            <div class="card-body">
                                                <form id="hideMessageForm">
                                                    <div class="mb-3">
                                                        <label class="form-label">Pesan Rahasia</label>
                                                        <textarea class="form-control" id="messageInput"
                                                            placeholder="Masukkan pesan yang ingin disembunyikan..."
                                                            rows="4"></textarea>
                                                        <small class="text-muted d-block mt-1">Karakter maksimal:
                                                            1000</small>
                                                    </div>

                                                    <div class="mb-3">
                                                        <label class="form-label">Pilih Gambar</label>
                                                        <div class="upload-area" id="uploadArea">
                                                            <i class="bi bi-cloud-upload"></i>
                                                            <p>Drag and drop gambar di sini atau klik untuk memilih</p>
                                                            <small class="text-muted">Tipe: JPG, PNG (Maksimal
                                                                5MB)</small>
                                                            <input type="file" id="imageInput" accept="image/*" hidden>
                                                        </div>
                                                        <div id="imagePreview" class="mt-3" style="display: none;">
                                                            <img id="previewImage" src="/placeholder.svg" alt="Preview"
                                                                class="img-thumbnail" style="max-width: 200px;">
                                                            <button type="button" class="btn btn-sm btn-danger ms-2"
                                                                id="removeImageBtn">Hapus</button>
                                                        </div>
                                                    </div>

                                                    <div class="d-flex gap-2">
                                                        <button type="submit" class="btn btn-primary">
                                                            <i class="bi bi-shield-check"></i> Sembunyikan & Download
                                                        </button>
                                                        <button type="reset" class="btn btn-outline-secondary">
                                                            <i class="bi bi-arrow-clockwise"></i> Bersihkan
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="card content-card">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">Informasi</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="info-item">
                                                    <i class="bi bi-info-circle"></i>
                                                    <div>
                                                        <strong>Cara Kerja</strong>
                                                        <p class="mb-0">Pesan Anda akan disembunyikan dalam pixel gambar
                                                            menggunakan teknik steganografi DCT (Discrete Cosine
                                                            Transform).
                                                        </p>
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class="info-item">
                                                    <i class="bi bi-shield-lock"></i>
                                                    <div>
                                                        <strong>Keamanan</strong>
                                                        <p class="mb-0">Pesan tidak terlihat secara visual dan gambar
                                                            akan terlihat normal di mata manusia.</p>
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class="info-item">
                                                    <i class="bi bi-lightning-charge"></i>
                                                    <div>
                                                        <strong>Kecepatan</strong>
                                                        <p class="mb-0">Proses dilakukan secara real-time di browser
                                                            Anda tanpa perlu upload ke server.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Reveal Message Tab -->
                            <div class="tab-pane fade" id="reveal-panel" role="tabpanel">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <div class="card content-card">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">Tampilkan Pesan dari Gambar</h5>
                                            </div>
                                            <div class="card-body">
                                                <form id="revealMessageForm">
                                                    <div class="mb-3">
                                                        <label class="form-label">Pilih Gambar yang Berisi Pesan</label>
                                                        <div class="upload-area" id="uploadAreaReveal">
                                                            <i class="bi bi-cloud-upload"></i>
                                                            <p>Drag and drop gambar yang sudah di-stegano di sini atau
                                                                klik untuk memilih</p>
                                                            <small class="text-muted">Tipe: JPG, PNG</small>
                                                            <input type="file" id="revealImageInput" accept="image/*"
                                                                hidden>
                                                        </div>
                                                        <div id="revealImagePreview" class="mt-3"
                                                            style="display: none;">
                                                            <img id="revealPreviewImage" src="/placeholder.svg"
                                                                alt="Preview" class="img-thumbnail"
                                                                style="max-width: 200px;">
                                                            <button type="button" class="btn btn-sm btn-danger ms-2"
                                                                id="removeRevealImageBtn">Hapus</button>
                                                        </div>
                                                    </div>

                                                    <button type="submit" class="btn btn-primary">
                                                        <i class="bi bi-eye"></i> Tampilkan Pesan
                                                    </button>
                                                </form>

                                                <!-- Result Container -->
                                                <div id="revealResult" class="mt-4" style="display: none;">
                                                    <div class="alert alert-success">
                                                        <strong>Pesan Tersembunyi:</strong>
                                                    </div>
                                                    <div class="result-message-box">
                                                        <p id="extracted-message">{{ extracted_message }}</p>
                                                    </div>
                                                    <button type="button" class="btn btn-sm btn-outline-primary mt-2"
                                                        id="copyMessageBtn">
                                                        <i class="bi bi-clipboard"></i> Salin Pesan
                                                    </button>
                                                </div>

                                                <div id="noMessageAlert" class="mt-4" style="display: none;">
                                                    <div class="alert alert-warning">
                                                        <i class="bi bi-exclamation-triangle"></i> Tidak ada pesan
                                                        tersembunyi ditemukan dalam gambar ini.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="card content-card">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">Tips & Trik</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="tips-list">
                                                    <div class="tip-item">
                                                        <span class="tip-number">1</span>
                                                        <p>Gunakan gambar dengan resolusi tinggi untuk pesan yang lebih
                                                            panjang</p>
                                                    </div>
                                                    <div class="tip-item">
                                                        <span class="tip-number">2</span>
                                                        <p>Hindari kompresi gambar setelah menyembunyikan pesan</p>
                                                    </div>
                                                    <div class="tip-item">
                                                        <span class="tip-number">3</span>
                                                        <p>Pesan bersifat rahasia dan tidak terlihat secara visual</p>
                                                    </div>
                                                    <div class="tip-item">
                                                        <span class="tip-number">4</span>
                                                        <p>Bagikan gambar dengan aman tanpa perlu khawatir pesan
                                                            terbongkar</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                          
                </section>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>